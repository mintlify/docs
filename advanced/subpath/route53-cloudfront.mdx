---
title: "AWS Route 53 and Cloudfront"
sidebarTitle: "AWS"
description: "Host documentation at a /docs subdirectory using AWS services"
---

import Propagating from "/snippets/custom-subpath-propagating.mdx";

To host your documentation at a `/docs` subpath using AWS Route 53 and Cloudfront, you need to configure your DNS provider to point to your Cloudfront distribution.

## Proxies with Vercel deployments

If you use AWS CloudFront as a proxy with Vercel deployments, you must configure CloudFront to avoid interfering with Vercel's domain verification and SSL certificate provisioning.

Improper CloudFront configuration can prevent Vercel from provisioning Let's Encrypt SSL certificates and cause domain verification failures.

### Required path allowlist

CloudFront must allow traffic to these specific paths without caching or blocking:

- `/.well-known/acme-challenge/*` - Required for Let's Encrypt certificate verification
- `/.well-known/vercel/*` - Required for Vercel domain verification

These paths should be configured to bypass CloudFront caching and pass through directly to your origin.

### Header forwarding requirements

You must create a custom origin request policy that forwards the `HOST` header and client IP information correctly. This is critical for Vercel's verification processes.

1. Create a custom origin request policy named `VercelCloudFrontProxy`.
2. Include the `Origin` and `CloudFront-Viewer-Address` headers.

You must include the `CloudFront-Viewer-Address` header in your origin request policy or cache policy headers configuration to forward the header to your origin.

## Create Cloudfront distribution

1. Navigate to [Cloudfront](https://aws.amazon.com/cloudfront) inside the AWS console.
2. Select **Create distribution**.

  <Frame>
    ![Cloudfront Distributions page with the "Create distribution" button emphasized.](/images/cloudfront/create-distribution.png)
  </Frame>

3. For the Origin domain, input `[SUBDOMAIN].mintlify.dev` where `[SUBDOMAIN]` is your project's unique subdomain.

  <Frame>
    ![Cloudfront "Create distribution" page showing "acme.mintlify.dev" as the origin domain.](/images/cloudfront/origin-name.png)
  </Frame>

4. Select **Use: [SUBDOMAIN].mintlify.dev**.

5. For "Cache key and origin requests", select **CachingOptimized** for the "Cache policy".

  <Frame>
    ![Cloudfront "Create distribution" page showing "CachingOptimized" selected for the cache key and origin requests policy.](/images/cloudfront/caching-policy.png)
  </Frame>

6. For "Web Application Firewall (WAF)," enable security protections.

  <Frame>
    ![Web Application Firewall (WAF) options with "Enable security protections" selected.](/images/cloudfront/enable-security-protections.png)
  </Frame>

7. The remaining settings should be default.
8. Select **Create distribution**.

## Add default origin

1. After creating the distribution, navigate to the "Origins" tab.

  <Frame>
    ![A Cloudfront distribution with the "Origins" tab highlighted.](/images/cloudfront/origins.png)
  </Frame>

2. Find your staging URL that mirrors the main domain. This is highly variant depending on how your landing page is hosted. For example, the Mintlify staging URL is [mintlify-landing-page.vercel.app](https://mintlify-landing-page.vercel.app).

<Info>
  If your landing page is hosted on Webflow, use Webflow's staging URL. It would look like `.webflow.io`.

  If you use Vercel, use the `.vercel.app` domain available for every project.
</Info>

3. Create a new Origin and add your staging URL as the "Origin domain".

  <Frame>
    ![Cloudfront "Create origin" page with a "Origin domain" input field highlighted.](/images/cloudfront/default-origin.png)
  </Frame>

By this point, you should have two Origins: one with `[SUBDOMAIN].mintlify.app` and another with with staging URL.

## Set behaviors

Behaviors in Cloudfront enable control over the subpath logic. At a high level, we're looking to create the following logic.

- **If a user lands on /docs**, go to `[SUBDOMAIN].mintlify.dev`.
- **If a user lands on any other page**, go the current landing page.

Select the **Create behavior** button and create the following behaviors.

### `/.well-known/*`

If you are deploying to Vercel, create a behavior for Vercel verification paths with a **Path pattern** of `/.well-known/*` and **Origin and origin groups** pointing to your main origin (the staging URL).

For "Cache policy", select **CachingDisabled** to ensure these verification requests pass through without caching.

### `/docs/*`

Create a behavior with a **Path pattern** of `/docs/*` with **Origin and origin groups** pointing to the `.mintlify.dev` URL (in our case `acme.mintlify.dev`).

For "Cache policy", select **CachingOptimized**. If you are using a Vercel deployment, select **VercelCloudFrontProxy** for the "Origin request policy."

<Frame>
  ![Cloudfront "Create behavior" page with a "Path pattern" of "/docs/*" and "Origin and origin groups" pointing to the `acme.mintlify.dev` URL.](/images/cloudfront/behavior-1.png)
</Frame>

### `/docs`

Create a behavior with a **Path pattern** of `/docs` and **Origin and origin groups** pointing to the same `.mintlify.dev` URL.

If you are using a Vercel deployment, select **VercelCloudFrontProxy** for the "Origin request policy."

<Frame>
  ![Cloudfront "Create behavior" page with a "Path pattern" of "/docs" and "Origin and origin groups" pointing to the `acme.mintlify.dev` URL.](/images/cloudfront/behavior-2.png)
</Frame>

### `Default (*)`

Lastly, we're going to edit the `Default (*)` behavior.

<Frame>
  ![A Cloudfront distribution with the "Default (*)" behavior selected and the Edit button emphasized.](/images/cloudfront/default-behavior-1.png)
</Frame>

1. Change the default behavior's **Origin and origin groups** to the staging URL (in our case `mintlify-landing-page.vercel.app`).

<Frame>
  ![Cloudfront "Edit behavior" page with the "Origin and origin groups" input field highlighted.](/images/cloudfront/default-behavior-2.png)
</Frame>

2. Select **Save changes**.

## Preview distribution

You can now test if your distribution is set up properly by going to the "General" tab and visiting the **Distribution domain name** URL.

<Frame>
  ![Cloudfront "General" tab with the "Distribution domain name" URL highlighted.](/images/cloudfront/preview-distribution.png)
</Frame>

All pages should be directing to your main landing page, but if you append `/docs` to the URL, you should see it going to your Mintlify documentation instance.

## Connect with Route53

Now, we're going to bring the functionality of the Cloudfront distribution into your primary domain.

<Note>
  For this section, you can also refer to AWS's official guide on [Configuring
  Amazon Route 53 to route traffic to a CloudFront
  distribution](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/routing-to-cloudfront-distribution.html#routing-to-cloudfront-distribution-config)
</Note>

1. Navigate to [Route53](https://aws.amazon.com/route53) inside the AWS console.
2. Navigate to the "Hosted zone" for your primary domain.
3. Select **Create record**.

<Frame>
  ![Route 53 "Records" page with the "Create record" button emphasized.](/images/cloudfront/route53-create-record.png)
</Frame>

4. Toggle `Alias` and then **Route traffic to** the `Alias to CloudFront distribution` option.

<Frame>
  ![Route 53 "Create record" page with the "Alias" toggle and the "Route traffic to" menu highlighted.](/images/cloudfront/create-record-alias.png)
</Frame>

5. Select **Create records**.

<Note>
  You may need to remove the existing A record if one currently exists.
</Note>

Your documentation is now live at `/docs` for your primary domain.

<Propagating />
