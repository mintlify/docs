---
title: "Tutorial: Auto-update documentation when code is changed"
sidebarTitle: "Automate documentation updates"
description: "Use the agent API to automatically update your documentation."
keywords: ["agent automation", "n8n", "GitHub Actions", "automatic doc updates"]
---

## Overview

Automatically update documentation when code is pushed to main. The agent API creates pull requests in your documentation repository based on changes in your code repository.

**Requirements:**
- Two repositories: code repository (where automation triggers) and documentation repository (where agent creates PRs)
- For monorepos, modify the workflow to target your documentation directory

## Choose your platform

<Tabs>
  <Tab title="GitHub Actions">

GitHub Actions is the simplest option if your code is already on GitHub. No additional services required.

## Prerequisites

- [Mintlify Enterprise plan](https://mintlify.com/pricing)
- [Mintlify GitHub App](/deploy/github) installed on both repositories
- [Mintlify admin API key](https://dashboard.mintlify.com/settings/organization/api-keys) and [project ID](https://dashboard.mintlify.com/settings/organization/api-keys)
- GitHub Actions enabled
- Admin access to both repositories

## Setup

### 1. Create workflow file

Create `.github/workflows/update-docs.yml` in your code repository:

    ```yaml
    name: Update Docs

    on:
      push:
        branches:
          - main

    jobs:
      update-docs:
        runs-on: ubuntu-latest
        steps:
          - uses: actions/github-script@v8
            env:
              MINTLIFY_API_KEY: ${{ secrets.MINTLIFY_API_KEY }}
              PROJECT_ID: ${{ secrets.MINTLIFY_PROJECT_ID }}
            with:
              script: |
                const { owner, repo } = context.repo;
                const projectId = process.env.PROJECT_ID;
                const apiKey = process.env.MINTLIFY_API_KEY;

                if (!projectId || !apiKey) {
                  core.setFailed('Missing MINTLIFY_PROJECT_ID or MINTLIFY_API_KEY secrets');
                  return;
                }

                const url = `https://api.mintlify.com/v1/agent/${projectId}/job`;
                const payload = {
                  branch: `mintlify/docs-update-${Date.now()}`,
                  messages: [
                    {
                      role: 'system',
                      content: 'You are an action runner that updates documentation based on code changes. You should never ask questions. If you are not able to access the repository, report the error and exit.'
                    },
                    {
                      role: 'user',
                      content: `Update the documentation for our recent pushes to main:\n\nRepository: ${owner}/${repo}`
                    }
                  ],
                  asDraft: false
                };

                try {
                  const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                      'Authorization': `Bearer ${apiKey}`,
                      'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                  });

                  if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}: ${await response.text()}`);
                  }

                  const reader = response.body.getReader();
                  const decoder = new TextDecoder();
                  let buffer = '';

                  while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;
                    buffer += decoder.decode(value, { stream: true });
                    const lines = buffer.split('\n');
                    buffer = lines.pop() || '';
                    for (const line of lines) {
                      if (line.trim()) {
                        console.log(line);
                      }
                    }
                  }
                  if (buffer.trim()) {
                    console.log(buffer);
                  }

                  core.notice(`Documentation update job triggered for ${owner}/${repo}`);
                } catch (error) {
                  core.setFailed(`Failed to create documentation update job: ${error.message}`);
                }
    ```

### 2. Add secrets

In your code repository: **Settings** → **Secrets and variables** → **Actions** → **New repository secret**

- `MINTLIFY_API_KEY`: Your admin API key
- `MINTLIFY_PROJECT_ID`: Your project ID from [API keys page](https://dashboard.mintlify.com/settings/organization/api-keys)

### 3. Test

Push to main and check the **Actions** tab. The agent will create a PR in your documentation repository.

## Troubleshooting

- **Workflow not running**: Check Actions tab, verify workflow file location
- **401 error**: Verify API key format (`Bearer mint_yourkey`) and organization
- **No updates**: Check documentation repository connection and agent write access

</Tab>

<Tab title="n8n">

## Prerequisites

- n8n workspace
- [Mintlify Enterprise plan](https://mintlify.com/pricing)
- [Mintlify app](/deploy/github) installed on code repository
- [Mintlify admin API key](https://dashboard.mintlify.com/settings/organization/api-keys) and [project ID](https://dashboard.mintlify.com/settings/organization/api-keys)
- GitHub personal access token with `repo` and `admin:repo_hook` scopes ([docs](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens))
- Admin access to both repositories

## Setup

### 1. Create webhook trigger

In n8n, add a webhook node with:
- HTTP Method: `POST`
- Path: `auto-update-documentation`
- Authentication: None
- Respond: Immediately

Copy the production webhook URL.

<Frame>
    <img src="/images/guides/n8n/webhook-node.png" alt="Screenshot of the configurations for the webhook node." style={{
      width: 'auto',
      height: '700px',
    }} />
</Frame>

### 2. Configure GitHub webhook

In your code repository: **Settings** → **Webhooks** → **Add webhook**

- Payload URL: Your n8n webhook URL
- Content type: `application/json`
- Events: Push events only
- Active: Enabled

### 3. Add filter node

Add a code node (mode: **Run Once for All Items**):

```javascript
const webhookData = $input.first().json.body;

// Only continue if this is a push to main
if (webhookData.ref !== "refs/heads/main") {
  return [];
}

// Extract information
const repository = webhookData.repository;
const pusher = webhookData.pusher;

// Build message for agent
const agentMessage = `Update documentation for changes pushed to main in ${repository.name}. Always edit files and create a pull request.`;

return {
  json: {
    codeRepoName: repository.full_name,
    codeRepoShortName: repository.name,
    agentMessage: agentMessage
  }
};
```

### 4. Add agent API node

Add HTTP request node:
- Method: `POST`
- URL: `https://api.mintlify.com/v1/agent/YOUR_PROJECT_ID/job`
- Authentication: Header Auth (`Authorization: Bearer mint_YOUR_API_KEY`)
- Body (JSON):

   ```json
   {
   "branch": "docs-update-from-{{ $json.codeRepoShortName }}-{{ $now.toISOString() }}",
   "messages": [
       {
       "role": "system",
       "content": "{{ $json.agentMessage }}"
       }
   ],
   "asDraft": false
   }
   ```

### 5. Activate and test

Save and activate the workflow. Push to main to trigger automation.

## Troubleshooting

- **Webhook not triggering**: Verify workflow active, check Recent Deliveries
- **401 from API**: Verify API key format (`Bearer mint_yourkey`) and organization
- **401 from GitHub**: Check token has `repo` scope and hasn't expired

</Tab>
</Tabs>
