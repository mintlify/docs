---
title: "GitLab"
description: "将文档与 GitLab 仓库同步"
icon: "gitlab"
---

我们结合使用 Access token 和 Webhook 进行认证，并在 GitLab 与 Mintlify 之间同步更改。

- 我们使用 Access token 从 GitLab 拉取信息。
- 我们使用 Webhook，让 GitLab 在发生更改时通知 Mintlify。
  - 这样，在创建 MR 时，Mintlify 就可以生成预览部署。

## 设置连接

<Steps>
  <Step title="查找项目 ID">
    在 GitLab 项目中，依次进入 `Settings` > `General`，找到 `Project ID`。
    <Frame>
      <img src="/images/gitlab/gitlab-project-id.png" />
    </Frame>
  </Step>
  <Step title="生成访问令牌">
    a. 前往 `Settings` > `Access Tokens`。

    b. 点击 `Add new token`。
      1. 将令牌命名为“Mintlify”。
      2. 如果是私有仓库，必须将角色设为 `Maintainer`。
      3. 将作用域勾选为 `api` 和 `read_api`。

    c. 点击 `Create project access token` 并复制生成的令牌。

    <Frame>
      <img src="/images/gitlab/gitlab-project-access-token.png" />
    </Frame>

  </Step>
  <Step title="设置连接">
    在 [Mintlify 控制台](https://dashboard.mintlify.com/settings/deployment/git-settings)中，将前述步骤获取的项目 ID 与访问令牌连同其他配置一并填写。完成后点击“Save Changes”。
    <Frame>
      <img src="/images/gitlab/gitlab-config.png" />
    </Frame>
  </Step>
</Steps>

## 创建 Webhook

Webhook 可在发生更改时向我们发送事件，从而自动触发部署。

<Steps>
  <Step title="导航至 Settings > Webhooks 并点击“Add new Webhook”">
    <Frame>
      <img src="/images/gitlab/gitlab-webhook.png" />
    </Frame>
  </Step>
  <Step title="设置 URL 和 Webhook">
    在“URL”字段中输入端点 `https://leaves.mintlify.com/gitlab-webhook`，并将 Webhook 命名为“Mintlify”。

  </Step>
  <Step title="粘贴令牌">
    粘贴在完成连接设置后生成的 Webhook 令牌。
    <Frame>
      <img src="/images/gitlab/gitlab-show-webtoken.png" />
    </Frame>
  </Step>
  <Step title="选择事件">
    选择你希望触发 Webhook 的事件：
      - Push events（All branches）
      - Merge requests events
      
    完成后应如下所示：
    <Frame>
      <img src="/images/gitlab/gitlab-project-webtoken.png" />
    </Frame>
  </Step>
  <Step title="测试 Webhook">
    创建 Webhook 后，点击“Test”下拉菜单并选择“Push events”以发送示例负载，验证配置是否正确。若配置正确，将显示“Hook executed successfully: HTTP 200”。

    这有助于你确认一切正常运行，并确保文档能与 GitLab 仓库正确同步。
    <Frame>
      <img src="/images/gitlab/gitlab-project-webtoken-test.png" />
    </Frame>

  </Step>
</Steps>

<Note>
  如需帮助，请联系 Mintlify 团队。可在
  [此处](https://mintlify.com/enterprise) 与我们取得联系。
</Note>

[git-settings]: https://dashboard.mintlify.com/settings/deployment/git-settings
