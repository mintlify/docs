---
title: "Vercel"
description: "使用 Vercel 在自定义子路径上托管文档"
---

import { VercelJsonGenerator } from "/snippets/zh/vercel-json-generator.mdx";


<div id="verceljson-file">
  ## vercel.json 文件
</div>

`vercel.json` 文件用于配置项目的构建与部署方式。它位于项目根目录，控制部署的各个方面，包括路由、重定向、请求头（headers）以及构建设置。

我们使用 `rewrites` 配置将来自主 domain 的请求代理到你的文档站点。

Rewrites 会在不改变浏览器中 URL 的情况下，将传入请求映射到其他目标。当有人访问 `yoursite.com/docs` 时，Vercel 会在内部从 `your-subdomain.mintlify.dev/docs` 获取内容，但用户在浏览器中仍会看到 `yoursite.com/docs`。这与重定向不同，重定向会将用户带到完全不同的 URL。

你可以将子路径自定义为任意你偏好的值，例如 `/docs`、`/help` 或 `/guides`。此外，你也可以使用更深层级的嵌套路由，如 `/product/docs`。

<div id="repository-structure">
  ## 存储库结构
</div>

你需要在存储库中组织文档文件，使其与所选的子路径结构一致。比如，如果你希望文档位于 `yoursite.com/docs`，就需要创建一个 `docs/` 目录，并将所有文档文件放入其中。

<div id="configuration">
  ## 配置
</div>

要使用 Vercel 在自定义子路径下托管文档，请在 `vercel.json` 文件中添加以下配置。此示例使用 `/docs`，你可以将其替换为任意子路径：

```json
{
  "rewrites": [
    {
      "source": "/docs",
      "destination": "https://[subdomain].mintlify.dev/docs"
    },
    {
      "source": "/docs/:match*",
      "destination": "https://[subdomain].mintlify.dev/docs/:match*"
    }
  ]
}
```

* **`source`**: 在你的 domain 上用于触发重写的路径模式。
* **`destination`**: 请求应被代理转发到的目标位置。
* **`:match*`**: 一个通配符，用于捕获子路径之后的任意路径段。

更多信息请参阅 Vercel 文档中的 [Configuring projects with vercel.json: Rewrites](https://vercel.com/docs/projects/project-configuration#rewrites)。


<div id="generate-rewrites">
  ### 生成重写规则
</div>

输入你的子域和自定义子目录，为你的 `vercel.json` 文件生成重写规则。

<VercelJsonGenerator />

<div id="using-external-proxies-with-vercel">
  ## 在 Vercel 中使用外部代理
</div>

如果你在 Vercel 部署前面使用外部代理（例如 Cloudflare 或 AWS CloudFront），必须正确配置它，以避免与 Vercel 的 domain 验证和 SSL 证书签发产生冲突。

错误的代理配置可能会导致 Vercel 无法签发 Let's Encrypt SSL 证书，并引发 domain 验证失败。

请参阅 Vercel 文档中的[支持的提供商](https://vercel.com/guides/how-to-setup-verified-proxy#supported-providers-verified-proxy-lite)。

<div id="required-path-allowlist">
  ### 必需的路径允许列表
</div>

你的外部代理必须允许以下特定路径的流量通过，且不得阻止、重定向或进行强缓存：

- `/.well-known/acme-challenge/*` - 颁发 Let's Encrypt 证书验证所必需
- `/.well-known/vercel/*` - 进行 Vercel domain 验证所必需
- `/mintlify-assets/_next/static/*` - 提供静态资源所必需

这些路径应原样直通到你的 Vercel 部署，不做任何修改。

<div id="header-forwarding-requirements">
  ### 请求头转发要求
</div>

请确保你的代理正确转发 `HOST` 请求头。否则，验证请求将失败。

<div id="testing-your-proxy-setup">
  ### 测试你的代理配置
</div>

要验证代理是否已正确配置：

1. 测试 `https://[yourdomain].com/.well-known/vercel/` 是否有返回。
2. 在 Vercel 控制台中确认 SSL 证书已正确签发。
3. 检查 domain 验证是否已成功完成。